{% extends 'base.html' %}

{% block content %}
<div class="container mt-4">
  <h2 class="mb-3">Movie Petitions</h2>
  <a href="{% url 'petitions:create' %}" class="btn btn-primary mb-3">+ Start a Petition</a>

  {% if petitions %}
    <div class="list-group">
      {% for petition in petitions %}
        <div class="list-group-item d-flex justify-content-between align-items-center">
          <div>
            <h5>{{ petition.title }}</h5>
            <p class="mb-1 text-muted">
              Posted by {{ petition.created_by.username }} on {{ petition.created_at|date:"M d, Y" }}
            </p>
            {% if petition.description %}
              <p>{{ petition.description }}</p>
            {% endif %}
          </div>

          <div class="text-end">
            <form method="post" action="{% url 'petitions:vote' petition.id %}">
              {% csrf_token %}
              <button class="btn btn-success btn-sm">Vote</button>
            </form>
            <span class="badge bg-dark mt-2">Votes: {{ petition.vote_count }}</span>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p>No petitions yet. <a href="{% url 'petitions:create' %}">Be the first to add one!</a></p>
  {% endif %}
</div>
{% endblock %}
